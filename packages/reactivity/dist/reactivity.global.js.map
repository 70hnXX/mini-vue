{
  "version": 3,
  "sources": ["../src/index.ts", "../../shared/src/index.ts", "../src/effect.ts", "../src/baseHandler.ts", "../src/reactive.ts"],
  "sourcesContent": ["export { reactive } from \"./reactive\";\nexport { effect } from \"./effect\";\n", "export const isObject = (value) => {\n  return typeof value === 'object' && value !== null;\n}", "export let activeEffect = undefined; // \u5BFC\u51FA\u6B64\u53D8\u91CF,\u4F7F\u5F97\u5916\u90E8\u53EF\u4EE5\u8BBF\u95EE\u5230ReactiveEffect\u5B9E\u4F8B\n\nclass ReactiveEffect {\n  public parent = null;\n  public active = true; // \u9ED8\u8BA4effect\u662F\u6FC0\u6D3B\u72B6\u6001,pulic\u4FEE\u9970\u7B26\u628A\u53D8\u91CF\u6216\u8005\u53C2\u6570\u653E\u5230this\u5B9E\u4F8B\u4E0A\n  constructor(public fn) {}\n\n  // \u6267\u884C\n  run() {\n    if (!this.active) {\n      return this.fn();\n    } // \u975E\u6FC0\u6D3B\u60C5\u51B5,\u53EA\u6267\u884C\u51FD\u6570,\u4E0D\u8FDB\u884C\u4F9D\u8D56\u6536\u96C6\n\n    // \u4F9D\u8D56\u6536\u96C6\n    try {\n      this.parent = activeEffect;\n      activeEffect = this;\n      return this.fn(); // \u6B64\u5904\u7684activeEffect,\u5728\u6267\u884Cfn\u7684\u65F6\u5019,\u4F7F\u5F97fn\u7684\u51FD\u6570\u5185\u90E8,\u80FD\u591F\u8BBF\u95EE\u5230\u8FD9\u4E2AReactiveEffect\n    } finally {\n      activeEffect = this.parent;\n    }\n  }\n}\n\nexport function effect(fn) {\n  // fn\u4F1A\u6839\u636E\u72B6\u6001,\u91CD\u65B0\u6267\u884C,effect\u53EF\u4EE5\u5D4C\u5957\u5199effect\n  const _effect = new ReactiveEffect(fn); // \u521B\u5EFA\u54CD\u5E94\u5F0F\u7684effect\n  _effect.run(); // \u9ED8\u8BA4\u6267\u884C\u4E00\u6B21\n}\n\nconst targetMap = new WeakMap();\nexport function track(target, type, key) {\n  // debugger;\n  if (!activeEffect) return;\n  // \u5BF9\u8C61\u7684\u67D0\u4E2A\u5C5E\u6027\u53EF\u4EE5\u5BF9\u5E94\u591A\u4E2Aeffect\n  // weakMap = {\u5BF9\u8C61:Map{name:Set}}\n  let depsMap = targetMap.get(target); // \u7B2C\u4E00\u6B21\u53D6\u80AF\u5B9A\u6CA1\u6709\n  if (!depsMap) {\n    targetMap.set(target, (depsMap = new Map()));\n  }\n  let dep = depsMap.get(key);\n  if (!dep) {\n    depsMap.set(key, (dep = new Set()));\n  }\n  let shouldTrack = !dep.has(activeEffect);\n  if (shouldTrack) {\n    dep.add(activeEffect);\n  }\n}\n", "import { track } from \"./effect\";\n\nexport const enum ReactiveFlags {\n  IS_REACTIVE = \"__v_isReactive\",\n}\n\nexport const mutableHandlers = {\n  get(target, key, reciver) {\n    if (key === ReactiveFlags.IS_REACTIVE) {\n      return true;\n    }\n    // effect\u7684\u4F9D\u8D56\u6536\u96C6\n    track(target, \"get\", key);\n    return Reflect.get(target, key, reciver);\n  },\n  set(target, key, value, reciver) {\n    return Reflect.set(target, key, value, reciver);\n  },\n};\n", "import { isObject } from \"@vue/shared\";\nimport { mutableHandlers, ReactiveFlags } from \"./baseHandler\";\n\nconst reactiveMap = new WeakMap(); //\n\nexport const reactive = (target) => {\n  // \u5224\u65AD\u662F\u5426\u4E3A\u5BF9\u8C61\uFF0C\u4E0D\u662F\u5BF9\u8C61\u5C31\u4E0D\u505A\u4EE3\u7406\n  if (!isObject(target)) return;\n  // \u5224\u65AD\u662F\u5426\u4EE3\u7406\u8FC7,\u672A\u88AB\u4EE3\u7406\u8FC7\u7684\u5BF9\u8C61,\u4F1A\u53D6'__v_isReactive'\u5C5E\u6027\uFF0C\u6CA1\u6709\u8FD9\u4E2A\u5C5E\u6027\uFF0C\u8FD4\u56DEfalse\n  // \u4EE3\u7406\u8FC7\u7684\u5BF9\u8C61\uFF0C\u662F\u4E00\u4E2Aproxy\uFF0C\u5C31\u4F1A\u53BB\u8C03\u7528get\uFF0C\u7136\u540Ekey === '__v_isReactive', \u8FD4\u56DEtrue\n  if (target[ReactiveFlags.IS_REACTIVE]) {\n    return target;\n  }\n  // \u67E5\u627E\u7F13\u5B58,\u4EE3\u7406\u8FC7\u7684\u5BF9\u8C61\uFF0C\u76F4\u63A5\u8FD4\u56DEproxy\n  let existingProxy = reactiveMap.get(target);\n  if (existingProxy) return existingProxy;\n  // \u8BBE\u7F6E\u4EE3\u7406\n  const proxy = new Proxy(target, mutableHandlers);\n\n  // \u7F13\u5B58\u4EE3\u7406,\u518D\u6B21\u4EE3\u7406\u65F6\u8FD4\u56DE\u4E0A\u4E00\u6B21\u7684\u4EE3\u7406\n  reactiveMap.set(target, proxy);\n\n  return proxy;\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAO,MAAM,WAAW,CAAC,UAAU;AACjC,WAAO,OAAO,UAAU,YAAY,UAAU;AAAA,EAChD;;;ACFO,MAAI,eAAe;AAE1B,MAAM,iBAAN,MAAqB;AAAA,IAGnB,YAAmB,IAAI;AAAJ;AAFnB,WAAO,SAAS;AAChB,WAAO,SAAS;AAAA,IACQ;AAAA,IAGxB,MAAM;AACJ,UAAI,CAAC,KAAK,QAAQ;AAChB,eAAO,KAAK,GAAG;AAAA,MACjB;AAGA,UAAI;AACF,aAAK,SAAS;AACd,uBAAe;AACf,eAAO,KAAK,GAAG;AAAA,MACjB,UAAE;AACA,uBAAe,KAAK;AAAA,MACtB;AAAA,IACF;AAAA,EACF;AAEO,kBAAgB,IAAI;AAEzB,UAAM,UAAU,IAAI,eAAe,EAAE;AACrC,YAAQ,IAAI;AAAA,EACd;AAEA,MAAM,YAAY,oBAAI,QAAQ;AACvB,iBAAe,QAAQ,MAAM,KAAK;AAEvC,QAAI,CAAC;AAAc;AAGnB,QAAI,UAAU,UAAU,IAAI,MAAM;AAClC,QAAI,CAAC,SAAS;AACZ,gBAAU,IAAI,QAAS,UAAU,oBAAI,IAAI,CAAE;AAAA,IAC7C;AACA,QAAI,MAAM,QAAQ,IAAI,GAAG;AACzB,QAAI,CAAC,KAAK;AACR,cAAQ,IAAI,KAAM,MAAM,oBAAI,IAAI,CAAE;AAAA,IACpC;AACA,QAAI,cAAc,CAAC,IAAI,IAAI,YAAY;AACvC,QAAI,aAAa;AACf,UAAI,IAAI,YAAY;AAAA,IACtB;AAAA,EACF;;;AC1CO,MAAM,kBAAkB;AAAA,IAC7B,IAAI,QAAQ,KAAK,SAAS;AACxB,UAAI,QAAQ,oCAA2B;AACrC,eAAO;AAAA,MACT;AAEA,YAAM,QAAQ,OAAO,GAAG;AACxB,aAAO,QAAQ,IAAI,QAAQ,KAAK,OAAO;AAAA,IACzC;AAAA,IACA,IAAI,QAAQ,KAAK,OAAO,SAAS;AAC/B,aAAO,QAAQ,IAAI,QAAQ,KAAK,OAAO,OAAO;AAAA,IAChD;AAAA,EACF;;;ACfA,MAAM,cAAc,oBAAI,QAAQ;AAEzB,MAAM,WAAW,CAAC,WAAW;AAElC,QAAI,CAAC,SAAS,MAAM;AAAG;AAGvB,QAAI,OAAO,qCAA4B;AACrC,aAAO;AAAA,IACT;AAEA,QAAI,gBAAgB,YAAY,IAAI,MAAM;AAC1C,QAAI;AAAe,aAAO;AAE1B,UAAM,QAAQ,IAAI,MAAM,QAAQ,eAAe;AAG/C,gBAAY,IAAI,QAAQ,KAAK;AAE7B,WAAO;AAAA,EACT;",
  "names": []
}
